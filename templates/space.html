<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>ğŸš€ Ø´Ù„ÛŒÚ© ÙØ¶Ø§ÛŒÛŒ</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  <style>
    canvas {
      background: black;
      display: block;
      margin: 30px auto;
      border: 2px solid #0ff;
    }
  </style>
</head>
<body>
  <h1>ğŸš€ Ø¨Ø§Ø²ÛŒ Ø´Ù„ÛŒÚ© ÙØ¶Ø§ÛŒÛŒ</h1>
  <p>Ø¨Ø§ Ú©Ù„ÛŒØ¯Ù‡Ø§ÛŒ â—€ï¸ â–¶ï¸ Ø­Ø±Ú©Øª Ú©Ù† Ùˆ Ø¨Ø§ Space Ø´Ù„ÛŒÚ© Ú©Ù†!</p>
  <canvas id="gameCanvas" width="400" height="500"></canvas>

  <script>
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');

    let spaceship = { x: 180, y: 450, w: 40, h: 40 };
    let bullets = [];
    let enemies = [];
    let score = 0;

    // Ø­Ø±Ú©Øª Ø³ÙÛŒÙ†Ù‡
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft' && spaceship.x > 0) spaceship.x -= 20;
      if (e.key === 'ArrowRight' && spaceship.x < 360) spaceship.x += 20;
      if (e.key === ' ') bullets.push({ x: spaceship.x + 18, y: spaceship.y });
    });

    // ØªÙˆÙ„ÛŒØ¯ Ø¯Ø´Ù…Ù†
    function spawnEnemy() {
      enemies.push({ x: Math.random() * 360, y: 0 });
    }

    // Ø­Ù„Ù‚Ù‡ Ø¨Ø§Ø²ÛŒ
    function gameLoop() {
      ctx.clearRect(0, 0, 400, 500);

      // Ø³ÙÛŒÙ†Ù‡
      ctx.fillStyle = 'cyan';
      ctx.fillRect(spaceship.x, spaceship.y, spaceship.w, spaceship.h);

      // Ú¯Ù„ÙˆÙ„Ù‡â€ŒÙ‡Ø§
      ctx.fillStyle = 'yellow';
      bullets.forEach((b, i) => {
        b.y -= 8;
        ctx.fillRect(b.x, b.y, 5, 10);
        if (b.y < 0) bullets.splice(i, 1);
      });

      // Ø¯Ø´Ù…Ù†â€ŒÙ‡Ø§
      ctx.fillStyle = 'red';
      enemies.forEach((en, i) => {
        en.y += 3;
        ctx.fillRect(en.x, en.y, 30, 30);

        // Ø¨Ø§Ø®Øª
        if (en.y > 480) {
          alert("Ø¨Ø§Ø®ØªÛŒ ğŸ˜¢ Ø§Ù…ØªÛŒØ§Ø²: " + score);
          document.location.reload();
        }

        // Ø¨Ø±Ø®ÙˆØ±Ø¯ Ú¯Ù„ÙˆÙ„Ù‡ Ø¨Ø§ Ø¯Ø´Ù…Ù†
        bullets.forEach((b, j) => {
          if (b.x < en.x + 30 && b.x + 5 > en.x && b.y < en.y + 30 && b.y + 10 > en.y) {
            enemies.splice(i, 1);
            bullets.splice(j, 1);
            score += 10;
          }
        });
      });

      // Ø§Ù…ØªÛŒØ§Ø²
      ctx.fillStyle = 'white';
      ctx.font = '16px sans-serif';
      ctx.fillText("Ø§Ù…ØªÛŒØ§Ø²: " + score, 10, 20);

      requestAnimationFrame(gameLoop);
    }

    setInterval(spawnEnemy, 1000);
    gameLoop();
  </script>
</body>
</html>